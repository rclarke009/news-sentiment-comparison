# Render Blueprint â€” News Sentiment Comparison
# https://render.com/docs/blueprint-spec
#
# Deploy: Connect this repo at https://dashboard.render.com/blueprints
# Add NEWS_API_KEY, GROQ_API_KEY (or OPENAI_API_KEY), MONGODB_URI in Dashboard
# (Blueprint will prompt for sync: false vars on first create.)

services:
  # FastAPI backend
  - type: web
    runtime: python
    name: news-sentiment-api
    buildCommand: pip install -r requirements.txt
    startCommand: uvicorn news_sentiment.api.main:app --host 0.0.0.0 --port $PORT
    healthCheckPath: /api/v1/health
    envVars:
      - key: NEWS_API_KEY
        sync: false
      - key: GROQ_API_KEY
        sync: false
      - key: OPENAI_API_KEY
        sync: false
      - key: MONGODB_URI
        sync: false
      - key: CORS_ORIGINS
        value: https://news-sentiment-frontend.onrender.com,https://sentimentlens.netlify.app

  # React frontend (static site)
  - type: web
    runtime: static
    name: news-sentiment-frontend
    buildCommand: cd frontend && npm install && npm run build
    staticPublishPath: frontend/dist
    envVars:
      - key: VITE_API_URL
        value: https://news-sentiment-api.onrender.com/api/v1

  # Daily headline collector (cron) - 10am UTC
  - type: cron
    name: news-sentiment-collector
    runtime: python
    schedule: "0 10 * * *"
    buildCommand: pip install -r requirements.txt
    startCommand: python scripts/run_collector.py
    envVars:
      - key: NEWS_API_KEY
        sync: false
      - key: GROQ_API_KEY
        sync: false
      - key: OPENAI_API_KEY
        sync: false
      - key: MONGODB_URI
        sync: false

  # Evening headline collector (cron) - 9pm EST / 2am UTC
  - type: cron
    name: news-sentiment-collector-evening
    runtime: python
    schedule: "0 2 * * *"
    buildCommand: pip install -r requirements.txt
    startCommand: python scripts/run_collector.py
    envVars:
      - key: NEWS_API_KEY
        sync: false
      - key: GROQ_API_KEY
        sync: false
      - key: OPENAI_API_KEY
        sync: false
      - key: MONGODB_URI
        sync: false
